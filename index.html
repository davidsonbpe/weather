<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Weather App</title>
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta name='description' content='Weather App Developer.'/>
    <meta name='application-name' content='Weather App'/>
    <meta name='apple-mobile-web-app-title' content='Weather App'>
    <meta name="theme-color" content="#4a3062" />
    <link rel="manifest" href="manifest.json"/>
    <link href='/pwa/images/icons/favicon.png' rel='shortcut icon'/>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'/>
    <meta name='mobile-web-app-capable' content='yes'/>
    <meta name='apple-mobile-web-app-capable' content='yes'/>
    <meta name='apple-mobile-web-app-status-bar-style' content='black'/>
    <link rel='icon' sizes='192x192' href='/pwa/images/icons/icon-192x192.png'/>
    <link rel='apple-touch-icon' href='/pwa/images/icons/icon-192x192.png'>
    <meta name='msapplication-TileImage' content='/pwa/images/icons/icon-144x144.png'/>
    <meta name='msapplication-TileColor' content='#2d2138'/>
    <link rel="stylesheet" href="css/style.css"/>
</head>

<body>

    <h1>Weather App</h1>
    
    
    <p id="location">City, Country</p>
    
    <p id="">
        <span id="temp">25</span>
        <span id="unit">°C</span>, 
        <span id="weather-name">Weather</span>, 
        <span id="weather-desc">Description</span>
    </p>
    
    <div class="container">
        <div id="weather"></div>
    </div>
    
    <div class="button">
        <button id="change_to">Change to <span id="change">°F</span></button>
    </div>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

    <footer id="footer">
        <p>Developer by <a href="https://davidsonbpe.blogspot.com/" target="_blank">Davidsonbpe</a>.</p>
    </footer>
    
    
    <div class="btn-group"><button class="buttonn" id="btnAddToHomeScreen" tabindex="0" data-trigger="click" class="ui" style="position:fixed;top:20px;right:24px; z-index: 99999;"><img class="fa-chomes" src="pwa/images/chomes.png" height="20"></button></div>


    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js', {
                    scope: '/'
                })
                .then(function(registration) {
                    console.log('Service Worker Registered');
                });
            navigator.serviceWorker.ready.then(function(registration) {
                console.log('Service Worker Ready');
            });
        }

        var deferredPrompt;

        window.addEventListener('beforeinstallprompt', function(e) {
            console.log('beforeinstallprompt Event fired');
            //e.preventDefault();
            deferredPrompt = e;

            return false;
        });

        btnAddToHomeScreen.addEventListener('click', function() {
            if (deferredPrompt !== undefined) {
                // The user has had a postive interaction with our app and Chrome
                // has tried to prompt previously, so let's show the prompt.
                deferredPrompt.prompt();

                // Follow what the user has done with the prompt.
                deferredPrompt.userChoice.then(function(choiceResult) {

                    console.log(choiceResult.outcome);

                    if (choiceResult.outcome == 'dismissed') {
                        console.log('User cancelled home screen install');
                    } else {
                        console.log('User added to home screen');
                    }

                    // We no longer need the prompt.  Clear it up.
                    deferredPrompt = null;
                });
            }
        });
        
            var calcHeight = function() {
               $('#preview-frame').height($(window).height());
             }

             $(document).ready(function() {
               calcHeight();
             }); 

             $(window).resize(function() {
               calcHeight();
             }).load(function() {
               calcHeight();
             });
            document.addEventListener('contextmenu', event => event.preventDefault()); /*---ti---*/

    </script>
    

    <script src="js/index.js"></script>

</body>

</html>
